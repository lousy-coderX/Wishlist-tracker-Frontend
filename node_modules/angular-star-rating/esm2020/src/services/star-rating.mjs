import { StarRatingUtils } from './star-rating.utils';
export class StarRating {
    constructor(config) {
        this.config = config;
        //set default ctrl props
        this.classEmpty = this.config.classEmpty;
        this.classHalf = this.config.classHalf;
        this.classFilled = this.config.classFilled;
        this.pathEmpty = this.config.svgPathEmpty;
        this.pathHalf = this.config.svgPathHalf;
        this.pathFilled = this.config.svgPathFilled;
        //set default Component Inputs
        if ('getColor' in this.config &&
            typeof this.config.getColor === 'function') {
            this.getColor = this.config.getColor;
        }
        if ('getHalfStarVisible' in this.config &&
            typeof this.config.getHalfStarVisible === 'function') {
            this.getHalfStarVisible = this.config.getHalfStarVisible;
        }
        this.numOfStars = this.config.numOfStars;
        this.rating = 0;
        this.step = 1;
    }
    /////////////////////////////////////////////
    set rating(value) {
        this.setRating(value);
    }
    get showHalfStars() {
        return this._showHalfStars;
    }
    set showHalfStars(value) {
        this._showHalfStars = !!value;
        //update halfStarVisible
        this.setHalfStarVisible();
    }
    get id() {
        return this._id;
    }
    set id(value) {
        this._id = value || '';
    }
    get focus() {
        return this._focus;
    }
    set focus(value) {
        this._focus = !!value;
    }
    get labelText() {
        return this._labelText;
    }
    set labelText(value) {
        this._labelText = value;
    }
    get labelPosition() {
        return this._labelPosition;
    }
    set labelPosition(value) {
        this._labelPosition = value || this.config.labelPosition;
    }
    get labelVisible() {
        return this._labelVisible;
    }
    set labelVisible(value) {
        this._labelVisible = !!value;
    }
    get hoverEnabled() {
        return this._hoverEnabled;
    }
    set hoverEnabled(value) {
        this._hoverEnabled = value !== undefined ? !!value : false;
    }
    get staticColor() {
        return this._staticColor || this.config.staticColor || undefined;
    }
    set staticColor(value) {
        this._staticColor = value;
        //update color.
        this.setColor();
    }
    get direction() {
        return this._direction;
    }
    set direction(value) {
        this._direction = value || undefined;
    }
    get numOfStars() {
        return this._numOfStars;
    }
    set numOfStars(value) {
        this._numOfStars = value > 0 ? value : this.config.numOfStars;
        //update stars array
        this.stars = StarRatingUtils.getStarsArray(this.numOfStars);
        //update color
        this.setColor();
    }
    get hoverRating() {
        return this._hoverRating;
    }
    set hoverRating(value) {
        this._hoverRating = value > 0 ? value : 0;
    }
    get speed() {
        return this._speed;
    }
    set speed(value) {
        this._speed = value || this.config.speed;
    }
    get size() {
        return this._size || this.config.size;
    }
    set size(value) {
        this._size = value;
    }
    get starType() {
        return this._starType || this.config.starType;
    }
    set starType(value) {
        this._starType = value;
    }
    get space() {
        return this._space;
    }
    set space(value) {
        this._space = value;
    }
    get readOnly() {
        return this._readOnly;
    }
    set readOnly(value) {
        this._readOnly = !!value;
    }
    get disabled() {
        return this._disabled;
    }
    set disabled(value) {
        this._disabled = !!value;
    }
    get step() {
        return this._step;
    }
    set step(value) {
        this._step = value > 0 ? value : 1;
    }
    get rating() {
        return this._rating;
    }
    /**
     * setRating
     * I use a setter function instead of a set method to enable overrides for this function.
     * @param value
     */
    setRating(value) {
        //validate and apply newRating
        let newRating = 0;
        if (value >= 0 && value <= this.numOfStars) {
            newRating = value;
        }
        //limit max value to max number of stars
        if (value > this.numOfStars) {
            newRating = this.numOfStars;
        }
        this._rating = newRating;
        //update ratingAsInteger. rating parsed to int for the value-[n] modifier
        this.ratingAsInteger = parseInt(this._rating.toString(), 10);
        //update halfStarsVisible
        this.setHalfStarVisible();
        //update calculated Color
        this.setColor();
    }
    svgVisible() {
        return this.starType === 'svg';
    }
    interactionPossible() {
        return !this.readOnly && !this.disabled;
    }
    setColor(useHoverValue = false) {
        console.log('useHoverValue: ', useHoverValue);
        //check if custom function is given
        const ratingValue = useHoverValue ? this.hoverRating : this.rating;
        if (typeof this.getColor === 'function') {
            this.color = this.getColor(ratingValue, this.numOfStars, this.staticColor);
        }
        else {
            this.color = StarRatingUtils.getColor(ratingValue, this.numOfStars, this.staticColor);
        }
    }
    setHalfStarVisible() {
        //update halfStarVisible
        if (this.showHalfStars) {
            //check if custom function is given
            if (typeof this.getHalfStarVisible === 'function') {
                this.halfStarVisible = this.getHalfStarVisible(this.rating);
            }
            else {
                this.halfStarVisible = StarRatingUtils.getHalfStarVisible(this.rating);
            }
        }
        else {
            this.halfStarVisible = false;
        }
    }
    getComponentClassNames() {
        const classNames = [];
        classNames.push(this.rating ? 'value-' + this.ratingAsInteger : 'value-0');
        classNames.push(this.halfStarVisible ? 'half' : '');
        classNames.push(this.hoverEnabled ? 'hover' : '');
        const hoverRating = this.hoverRating
            ? 'hover-' + this.hoverRating
            : 'hover-0';
        classNames.push(this.hoverEnabled ? hoverRating : '');
        classNames.push(this.space ? 'space-' + this.space : '');
        classNames.push(this.labelPosition ? 'label-' + this.labelPosition : '');
        classNames.push(this.color ? 'color-' + this.color : '');
        classNames.push(this.starType ? 'star-' + this.starType : '');
        classNames.push(this.speed);
        classNames.push(this.size);
        classNames.push(this.readOnly ? 'read-only' : '');
        classNames.push(this.disabled ? 'disabled' : '');
        classNames.push(this.direction ? 'direction-' + this.direction : '');
        return classNames.join(' ');
    }
    increment() {
        //increment to next higher step
        const absDiff = Math.abs(this.rating % this.step);
        this.rating = this.rating + (absDiff > 0 ? this.step - absDiff : this.step);
    }
    decrement() {
        //decrement to next lower step
        const absDiff = Math.abs(this.rating % this.step);
        this.rating = this.rating - (absDiff > 0 ? absDiff : this.step);
    }
    reset() {
        this.rating = 0;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3Rhci1yYXRpbmcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9saWJzL2FuZ3VsYXItc3Rhci1yYXRpbmcvc3JjL3NlcnZpY2VzL3N0YXItcmF0aW5nLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVdBLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUV0RCxNQUFNLE9BQU8sVUFBVTtJQWtWckIsWUFBWSxNQUErQjtRQUN6QyxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztRQUVyQix3QkFBd0I7UUFDeEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQztRQUN6QyxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUM7UUFDM0MsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQztRQUMxQyxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDO1FBQ3hDLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUM7UUFFNUMsOEJBQThCO1FBQzlCLElBQ0UsVUFBVSxJQUFJLElBQUksQ0FBQyxNQUFNO1lBQ3pCLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEtBQUssVUFBVSxFQUMxQztZQUNBLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUM7U0FDdEM7UUFFRCxJQUNFLG9CQUFvQixJQUFJLElBQUksQ0FBQyxNQUFNO1lBQ25DLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxrQkFBa0IsS0FBSyxVQUFVLEVBQ3BEO1lBQ0EsSUFBSSxDQUFDLGtCQUFrQixH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RCxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzlFLENBQUM7SUFFRCxTQUFTO1FBQ1AsOEJBQThCO1FBQzlCLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbEQsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbEUsQ0FBQztJQUVELEtBQUs7UUFDSCxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztJQUNsQixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBTdGFyUmF0aW5nQ29uZmlnLFxuICBzdGFyUmF0aW5nQ29sb3IsXG4gIHN0YXJSYXRpbmdEaXJlY3Rpb24sXG4gIHN0YXJSYXRpbmdMYWJlbFBvc2l0aW9uLFxuICBzdGFyUmF0aW5nU2l6ZXMsXG4gIHN0YXJSYXRpbmdTcGVlZCxcbiAgc3RhclJhdGluZ1N0YXJTcGFjZSxcbiAgc3RhclJhdGluZ1N0YXJUeXBlcyxcbn0gZnJvbSAnLi4vaW50ZXJmYWNlcy9zdGFyLXJhdGluZy1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IFN0YXJSYXRpbmdDb25maWdTZXJ2aWNlIH0gZnJvbSAnLi9zdGFyLXJhdGluZy1jb25maWcuc2VydmljZSc7XG5pbXBvcnQgeyBTdGFyUmF0aW5nVXRpbHMgfSBmcm9tICcuL3N0YXItcmF0aW5nLnV0aWxzJztcblxuZXhwb3J0IGNsYXNzIFN0YXJSYXRpbmcge1xuICBwcm90ZWN0ZWQgY29uZmlnOiBTdGFyUmF0aW5nQ29uZmlnO1xuXG4gIC8vQ1RSTCBPTkxZXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgY2xhc3NFbXB0eTogc3RyaW5nO1xuICBjbGFzc0hhbGY6IHN0cmluZztcbiAgY2xhc3NGaWxsZWQ6IHN0cmluZztcblxuICBwYXRoRW1wdHk6IHN0cmluZztcbiAgcGF0aEhhbGY6IHN0cmluZztcbiAgcGF0aEZpbGxlZDogc3RyaW5nO1xuXG4gIGNvbG9yOiBzdGFyUmF0aW5nQ29sb3I7XG4gIHN0YXJzOiBBcnJheTxudW1iZXI+O1xuICByYXRpbmdBc0ludGVnZXI6IG51bWJlcjtcbiAgaGFsZlN0YXJWaXNpYmxlOiBib29sZWFuO1xuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIHNldCByYXRpbmcodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuc2V0UmF0aW5nKHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBzaG93SGFsZlN0YXJzXG4gICAqL1xuICBwcm90ZWN0ZWQgX3Nob3dIYWxmU3RhcnM6IGJvb2xlYW47XG4gIGdldCBzaG93SGFsZlN0YXJzKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9zaG93SGFsZlN0YXJzO1xuICB9XG5cbiAgc2V0IHNob3dIYWxmU3RhcnModmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9zaG93SGFsZlN0YXJzID0gISF2YWx1ZTtcblxuICAgIC8vdXBkYXRlIGhhbGZTdGFyVmlzaWJsZVxuICAgIHRoaXMuc2V0SGFsZlN0YXJWaXNpYmxlKCk7XG4gIH1cblxuICAvKipcbiAgICogZ2V0Q29sb3JcbiAgICovXG4gIGdldENvbG9yOiAoXG4gICAgcmF0aW5nOiBudW1iZXIsXG4gICAgbnVtT2ZTdGFyczogbnVtYmVyLFxuICAgIHN0YXRpY0NvbG9yPzogc3RhclJhdGluZ0NvbG9yXG4gICkgPT4gc3RhclJhdGluZ0NvbG9yO1xuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogZ2V0SGFsZlN0YXJWaXNpYmxlXG4gICAqL1xuICBnZXRIYWxmU3RhclZpc2libGU6IChyYXRpbmc6IG51bWJlcikgPT4gYm9vbGVhbjtcbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLy9JbnB1dHNcbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBpZCBwcm9wZXJ0eSB0byBpZGVudGlmeSB0aGUgRE9NIGVsZW1lbnRcbiAgICovXG4gIHByb3RlY3RlZCBfaWQ6IHN0cmluZztcbiAgZ2V0IGlkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG5cbiAgc2V0IGlkKHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLl9pZCA9IHZhbHVlIHx8ICcnO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIGZvY3VzXG4gICAqL1xuICBwcm90ZWN0ZWQgX2ZvY3VzOiBib29sZWFuO1xuICBnZXQgZm9jdXMoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2ZvY3VzO1xuICB9XG5cbiAgc2V0IGZvY3VzKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5fZm9jdXMgPSAhIXZhbHVlO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIGxhYmVsVGV4dFxuICAgKi9cbiAgcHJvdGVjdGVkIF9sYWJlbFRleHQ6IHN0cmluZztcbiAgZ2V0IGxhYmVsVGV4dCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9sYWJlbFRleHQ7XG4gIH1cblxuICBzZXQgbGFiZWxUZXh0KHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLl9sYWJlbFRleHQgPSB2YWx1ZTtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBsYWJlbFBvc2l0aW9uXG4gICAqL1xuICBwcm90ZWN0ZWQgX2xhYmVsUG9zaXRpb246IHN0YXJSYXRpbmdMYWJlbFBvc2l0aW9uO1xuICBnZXQgbGFiZWxQb3NpdGlvbigpOiBzdGFyUmF0aW5nTGFiZWxQb3NpdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMuX2xhYmVsUG9zaXRpb247XG4gIH1cblxuICBzZXQgbGFiZWxQb3NpdGlvbih2YWx1ZTogc3RhclJhdGluZ0xhYmVsUG9zaXRpb24pIHtcbiAgICB0aGlzLl9sYWJlbFBvc2l0aW9uID0gdmFsdWUgfHwgdGhpcy5jb25maWcubGFiZWxQb3NpdGlvbjtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBsYWJlbFZpc2libGVcbiAgICovXG4gIHByb3RlY3RlZCBfbGFiZWxWaXNpYmxlOiBib29sZWFuO1xuICBnZXQgbGFiZWxWaXNpYmxlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9sYWJlbFZpc2libGU7XG4gIH1cblxuICBzZXQgbGFiZWxWaXNpYmxlKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5fbGFiZWxWaXNpYmxlID0gISF2YWx1ZTtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBob3ZlckVuYWJsZWRcbiAgICovXG4gIHByb3RlY3RlZCBfaG92ZXJFbmFibGVkOiBib29sZWFuO1xuICBnZXQgaG92ZXJFbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9ob3ZlckVuYWJsZWQ7XG4gIH1cblxuICBzZXQgaG92ZXJFbmFibGVkKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5faG92ZXJFbmFibGVkID0gdmFsdWUgIT09IHVuZGVmaW5lZCA/ICEhdmFsdWUgOiBmYWxzZTtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBzdGF0aWNDb2xvclxuICAgKi9cbiAgcHJvdGVjdGVkIF9zdGF0aWNDb2xvcjogc3RhclJhdGluZ0NvbG9yO1xuICBnZXQgc3RhdGljQ29sb3IoKTogc3RhclJhdGluZ0NvbG9yIHtcbiAgICByZXR1cm4gdGhpcy5fc3RhdGljQ29sb3IgfHwgdGhpcy5jb25maWcuc3RhdGljQ29sb3IgfHwgdW5kZWZpbmVkO1xuICB9XG5cbiAgc2V0IHN0YXRpY0NvbG9yKHZhbHVlOiBzdGFyUmF0aW5nQ29sb3IpIHtcbiAgICB0aGlzLl9zdGF0aWNDb2xvciA9IHZhbHVlO1xuXG4gICAgLy91cGRhdGUgY29sb3IuXG4gICAgdGhpcy5zZXRDb2xvcigpO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIGRpcmVjdGlvblxuICAgKi9cbiAgcHJvdGVjdGVkIF9kaXJlY3Rpb246IHN0YXJSYXRpbmdEaXJlY3Rpb247XG4gIGdldCBkaXJlY3Rpb24oKTogc3RhclJhdGluZ0RpcmVjdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMuX2RpcmVjdGlvbjtcbiAgfVxuXG4gIHNldCBkaXJlY3Rpb24odmFsdWU6IHN0YXJSYXRpbmdEaXJlY3Rpb24pIHtcbiAgICB0aGlzLl9kaXJlY3Rpb24gPSB2YWx1ZSB8fCB1bmRlZmluZWQ7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogbnVtT2ZTdGFyc1xuICAgKi9cbiAgcHJvdGVjdGVkIF9udW1PZlN0YXJzOiBudW1iZXI7XG4gIGdldCBudW1PZlN0YXJzKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX251bU9mU3RhcnM7XG4gIH1cblxuICBzZXQgbnVtT2ZTdGFycyh2YWx1ZTogbnVtYmVyKSB7XG4gICAgdGhpcy5fbnVtT2ZTdGFycyA9IHZhbHVlID4gMCA/IHZhbHVlIDogdGhpcy5jb25maWcubnVtT2ZTdGFycztcblxuICAgIC8vdXBkYXRlIHN0YXJzIGFycmF5XG4gICAgdGhpcy5zdGFycyA9IFN0YXJSYXRpbmdVdGlscy5nZXRTdGFyc0FycmF5KHRoaXMubnVtT2ZTdGFycyk7XG5cbiAgICAvL3VwZGF0ZSBjb2xvclxuICAgIHRoaXMuc2V0Q29sb3IoKTtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBob3ZlclJhdGluZ1xuICAgKi9cbiAgcHJvdGVjdGVkIF9ob3ZlclJhdGluZzogbnVtYmVyO1xuICBnZXQgaG92ZXJSYXRpbmcoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5faG92ZXJSYXRpbmc7XG4gIH1cblxuICBzZXQgaG92ZXJSYXRpbmcodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuX2hvdmVyUmF0aW5nID0gdmFsdWUgPiAwID8gdmFsdWUgOiAwO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIHNwZWVkXG4gICAqL1xuICBwcm90ZWN0ZWQgX3NwZWVkOiBzdGFyUmF0aW5nU3BlZWQ7XG4gIGdldCBzcGVlZCgpOiBzdGFyUmF0aW5nU3BlZWQge1xuICAgIHJldHVybiB0aGlzLl9zcGVlZDtcbiAgfVxuXG4gIHNldCBzcGVlZCh2YWx1ZTogc3RhclJhdGluZ1NwZWVkKSB7XG4gICAgdGhpcy5fc3BlZWQgPSB2YWx1ZSB8fCB0aGlzLmNvbmZpZy5zcGVlZDtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBzaXplXG4gICAqL1xuICBwcm90ZWN0ZWQgX3NpemU6IHN0YXJSYXRpbmdTaXplcztcbiAgZ2V0IHNpemUoKTogc3RhclJhdGluZ1NpemVzIHtcbiAgICByZXR1cm4gdGhpcy5fc2l6ZSB8fCB0aGlzLmNvbmZpZy5zaXplO1xuICB9XG5cbiAgc2V0IHNpemUodmFsdWU6IHN0YXJSYXRpbmdTaXplcykge1xuICAgIHRoaXMuX3NpemUgPSB2YWx1ZTtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBzdGFyVHlwZVxuICAgKi9cbiAgcHJvdGVjdGVkIF9zdGFyVHlwZTogc3RhclJhdGluZ1N0YXJUeXBlcztcbiAgZ2V0IHN0YXJUeXBlKCk6IHN0YXJSYXRpbmdTdGFyVHlwZXMge1xuICAgIHJldHVybiB0aGlzLl9zdGFyVHlwZSB8fCB0aGlzLmNvbmZpZy5zdGFyVHlwZTtcbiAgfVxuXG4gIHNldCBzdGFyVHlwZSh2YWx1ZTogc3RhclJhdGluZ1N0YXJUeXBlcykge1xuICAgIHRoaXMuX3N0YXJUeXBlID0gdmFsdWU7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogc3BhY2VcbiAgICovXG4gIHByb3RlY3RlZCBfc3BhY2U6IHN0YXJSYXRpbmdTdGFyU3BhY2U7XG4gIGdldCBzcGFjZSgpOiBzdGFyUmF0aW5nU3RhclNwYWNlIHtcbiAgICByZXR1cm4gdGhpcy5fc3BhY2U7XG4gIH1cblxuICBzZXQgc3BhY2UodmFsdWU6IHN0YXJSYXRpbmdTdGFyU3BhY2UpIHtcbiAgICB0aGlzLl9zcGFjZSA9IHZhbHVlO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIHJlYWRPbmx5XG4gICAqL1xuICBwcm90ZWN0ZWQgX3JlYWRPbmx5OiBib29sZWFuO1xuICBnZXQgcmVhZE9ubHkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX3JlYWRPbmx5O1xuICB9XG5cbiAgc2V0IHJlYWRPbmx5KHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5fcmVhZE9ubHkgPSAhIXZhbHVlO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIGRpc2FibGVkXG4gICAqL1xuICBwcm90ZWN0ZWQgX2Rpc2FibGVkOiBib29sZWFuO1xuICBnZXQgZGlzYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2Rpc2FibGVkO1xuICB9XG5cbiAgc2V0IGRpc2FibGVkKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5fZGlzYWJsZWQgPSAhIXZhbHVlO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgcHJpdmF0ZSBfc3RlcDogbnVtYmVyO1xuICBnZXQgc3RlcCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9zdGVwO1xuICB9XG5cbiAgc2V0IHN0ZXAodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuX3N0ZXAgPSB2YWx1ZSA+IDAgPyB2YWx1ZSA6IDE7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogcmF0aW5nXG4gICAqL1xuICBwcm90ZWN0ZWQgX3JhdGluZzogbnVtYmVyO1xuICBnZXQgcmF0aW5nKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX3JhdGluZztcbiAgfVxuXG4gIC8qKlxuICAgKiBzZXRSYXRpbmdcbiAgICogSSB1c2UgYSBzZXR0ZXIgZnVuY3Rpb24gaW5zdGVhZCBvZiBhIHNldCBtZXRob2QgdG8gZW5hYmxlIG92ZXJyaWRlcyBmb3IgdGhpcyBmdW5jdGlvbi5cbiAgICogQHBhcmFtIHZhbHVlXG4gICAqL1xuICBzZXRSYXRpbmcodmFsdWU6IG51bWJlcikge1xuICAgIC8vdmFsaWRhdGUgYW5kIGFwcGx5IG5ld1JhdGluZ1xuICAgIGxldCBuZXdSYXRpbmcgPSAwO1xuICAgIGlmICh2YWx1ZSA+PSAwICYmIHZhbHVlIDw9IHRoaXMubnVtT2ZTdGFycykge1xuICAgICAgbmV3UmF0aW5nID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLy9saW1pdCBtYXggdmFsdWUgdG8gbWF4IG51bWJlciBvZiBzdGFyc1xuICAgIGlmICh2YWx1ZSA+IHRoaXMubnVtT2ZTdGFycykge1xuICAgICAgbmV3UmF0aW5nID0gdGhpcy5udW1PZlN0YXJzO1xuICAgIH1cbiAgICB0aGlzLl9yYXRpbmcgPSBuZXdSYXRpbmc7XG5cbiAgICAvL3VwZGF0ZSByYXRpbmdBc0ludGVnZXIuIHJhdGluZyBwYXJzZWQgdG8gaW50IGZvciB0aGUgdmFsdWUtW25dIG1vZGlmaWVyXG4gICAgdGhpcy5yYXRpbmdBc0ludGVnZXIgPSBwYXJzZUludCh0aGlzLl9yYXRpbmcudG9TdHJpbmcoKSwgMTApO1xuXG4gICAgLy91cGRhdGUgaGFsZlN0YXJzVmlzaWJsZVxuICAgIHRoaXMuc2V0SGFsZlN0YXJWaXNpYmxlKCk7XG5cbiAgICAvL3VwZGF0ZSBjYWxjdWxhdGVkIENvbG9yXG4gICAgdGhpcy5zZXRDb2xvcigpO1xuICB9XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBTdGFyUmF0aW5nQ29uZmlnU2VydmljZSkge1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuXG4gICAgLy9zZXQgZGVmYXVsdCBjdHJsIHByb3BzXG4gICAgdGhpcy5jbGFzc0VtcHR5ID0gdGhpcy5jb25maWcuY2xhc3NFbXB0eTtcbiAgICB0aGlzLmNsYXNzSGFsZiA9IHRoaXMuY29uZmlnLmNsYXNzSGFsZjtcbiAgICB0aGlzLmNsYXNzRmlsbGVkID0gdGhpcy5jb25maWcuY2xhc3NGaWxsZWQ7XG4gICAgdGhpcy5wYXRoRW1wdHkgPSB0aGlzLmNvbmZpZy5zdmdQYXRoRW1wdHk7XG4gICAgdGhpcy5wYXRoSGFsZiA9IHRoaXMuY29uZmlnLnN2Z1BhdGhIYWxmO1xuICAgIHRoaXMucGF0aEZpbGxlZCA9IHRoaXMuY29uZmlnLnN2Z1BhdGhGaWxsZWQ7XG5cbiAgICAvL3NldCBkZWZhdWx0IENvbXBvbmVudCBJbnB1dHNcbiAgICBpZiAoXG4gICAgICAnZ2V0Q29sb3InIGluIHRoaXMuY29uZmlnICYmXG4gICAgICB0eXBlb2YgdGhpcy5jb25maWcuZ2V0Q29sb3IgPT09ICdmdW5jdGlvbidcbiAgICApIHtcbiAgICAgIHRoaXMuZ2V0Q29sb3IgPSB0aGlzLmNvbmZpZy5nZXRDb2xvcjtcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICAnZ2V0SGFsZlN0YXJWaXNpYmxlJyBpbiB0aGlzLmNvbmZpZyAmJlxuICAgICAgdHlwZW9mIHRoaXMuY29uZmlnLmdldEhhbGZTdGFyVmlzaWJsZSA9PT0gJ2Z1bmN0aW9uJ1xuICAgICkge1xuICAgICAgdGhpcy5nZXRIYWxmU3RhclZpc2libGUgPSB0aGlzLmNvbmZpZy5nZXRIYWxmU3RhclZpc2libGU7XG4gICAgfVxuXG4gICAgdGhpcy5udW1PZlN0YXJzID0gdGhpcy5jb25maWcubnVtT2ZTdGFycztcbiAgICB0aGlzLnJhdGluZyA9IDA7XG4gICAgdGhpcy5zdGVwID0gMTtcbiAgfVxuXG4gIHN2Z1Zpc2libGUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuc3RhclR5cGUgPT09ICdzdmcnO1xuICB9XG5cbiAgaW50ZXJhY3Rpb25Qb3NzaWJsZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIXRoaXMucmVhZE9ubHkgJiYgIXRoaXMuZGlzYWJsZWQ7XG4gIH1cblxuICBzZXRDb2xvcih1c2VIb3ZlclZhbHVlID0gZmFsc2UpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygndXNlSG92ZXJWYWx1ZTogJywgdXNlSG92ZXJWYWx1ZSk7XG4gICAgLy9jaGVjayBpZiBjdXN0b20gZnVuY3Rpb24gaXMgZ2l2ZW5cbiAgICBjb25zdCByYXRpbmdWYWx1ZSA9IHVzZUhvdmVyVmFsdWUgPyB0aGlzLmhvdmVyUmF0aW5nIDogdGhpcy5yYXRpbmc7XG4gICAgaWYgKHR5cGVvZiB0aGlzLmdldENvbG9yID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aGlzLmNvbG9yID0gdGhpcy5nZXRDb2xvcihcbiAgICAgICAgcmF0aW5nVmFsdWUsXG4gICAgICAgIHRoaXMubnVtT2ZTdGFycyxcbiAgICAgICAgdGhpcy5zdGF0aWNDb2xvclxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jb2xvciA9IFN0YXJSYXRpbmdVdGlscy5nZXRDb2xvcihcbiAgICAgICAgcmF0aW5nVmFsdWUsXG4gICAgICAgIHRoaXMubnVtT2ZTdGFycyxcbiAgICAgICAgdGhpcy5zdGF0aWNDb2xvclxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBzZXRIYWxmU3RhclZpc2libGUoKTogdm9pZCB7XG4gICAgLy91cGRhdGUgaGFsZlN0YXJWaXNpYmxlXG4gICAgaWYgKHRoaXMuc2hvd0hhbGZTdGFycykge1xuICAgICAgLy9jaGVjayBpZiBjdXN0b20gZnVuY3Rpb24gaXMgZ2l2ZW5cbiAgICAgIGlmICh0eXBlb2YgdGhpcy5nZXRIYWxmU3RhclZpc2libGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5oYWxmU3RhclZpc2libGUgPSB0aGlzLmdldEhhbGZTdGFyVmlzaWJsZSh0aGlzLnJhdGluZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmhhbGZTdGFyVmlzaWJsZSA9IFN0YXJSYXRpbmdVdGlscy5nZXRIYWxmU3RhclZpc2libGUodGhpcy5yYXRpbmcpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmhhbGZTdGFyVmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGdldENvbXBvbmVudENsYXNzTmFtZXMoKTogc3RyaW5nIHtcbiAgICBjb25zdCBjbGFzc05hbWVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgY2xhc3NOYW1lcy5wdXNoKHRoaXMucmF0aW5nID8gJ3ZhbHVlLScgKyB0aGlzLnJhdGluZ0FzSW50ZWdlciA6ICd2YWx1ZS0wJyk7XG4gICAgY2xhc3NOYW1lcy5wdXNoKHRoaXMuaGFsZlN0YXJWaXNpYmxlID8gJ2hhbGYnIDogJycpO1xuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLmhvdmVyRW5hYmxlZCA/ICdob3ZlcicgOiAnJyk7XG5cbiAgICBjb25zdCBob3ZlclJhdGluZyA9IHRoaXMuaG92ZXJSYXRpbmdcbiAgICAgID8gJ2hvdmVyLScgKyB0aGlzLmhvdmVyUmF0aW5nXG4gICAgICA6ICdob3Zlci0wJztcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5ob3ZlckVuYWJsZWQgPyBob3ZlclJhdGluZyA6ICcnKTtcblxuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLnNwYWNlID8gJ3NwYWNlLScgKyB0aGlzLnNwYWNlIDogJycpO1xuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLmxhYmVsUG9zaXRpb24gPyAnbGFiZWwtJyArIHRoaXMubGFiZWxQb3NpdGlvbiA6ICcnKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5jb2xvciA/ICdjb2xvci0nICsgdGhpcy5jb2xvciA6ICcnKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5zdGFyVHlwZSA/ICdzdGFyLScgKyB0aGlzLnN0YXJUeXBlIDogJycpO1xuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLnNwZWVkKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5zaXplKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5yZWFkT25seSA/ICdyZWFkLW9ubHknIDogJycpO1xuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLmRpc2FibGVkID8gJ2Rpc2FibGVkJyA6ICcnKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5kaXJlY3Rpb24gPyAnZGlyZWN0aW9uLScgKyB0aGlzLmRpcmVjdGlvbiA6ICcnKTtcblxuICAgIHJldHVybiBjbGFzc05hbWVzLmpvaW4oJyAnKTtcbiAgfVxuXG4gIGluY3JlbWVudCgpIHtcbiAgICAvL2luY3JlbWVudCB0byBuZXh0IGhpZ2hlciBzdGVwXG4gICAgY29uc3QgYWJzRGlmZiA9IE1hdGguYWJzKHRoaXMucmF0aW5nICUgdGhpcy5zdGVwKTtcbiAgICB0aGlzLnJhdGluZyA9IHRoaXMucmF0aW5nICsgKGFic0RpZmYgPiAwID8gdGhpcy5zdGVwIC0gYWJzRGlmZiA6IHRoaXMuc3RlcCk7XG4gIH1cblxuICBkZWNyZW1lbnQoKSB7XG4gICAgLy9kZWNyZW1lbnQgdG8gbmV4dCBsb3dlciBzdGVwXG4gICAgY29uc3QgYWJzRGlmZiA9IE1hdGguYWJzKHRoaXMucmF0aW5nICUgdGhpcy5zdGVwKTtcbiAgICB0aGlzLnJhdGluZyA9IHRoaXMucmF0aW5nIC0gKGFic0RpZmYgPiAwID8gYWJzRGlmZiA6IHRoaXMuc3RlcCk7XG4gIH1cblxuICByZXNldCgpIHtcbiAgICB0aGlzLnJhdGluZyA9IDA7XG4gIH1cbn1cbiJdfQ==